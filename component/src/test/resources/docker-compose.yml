version: '2'

services:
  mongo_1:
    image: mongo
    command: mongod --smallfiles --replSet rs
  mongo_2:
    image: mongo
    command: mongod --smallfiles --replSet rs
  mongo_3:
    image: mongo
    command: mongod --smallfiles --replSet rs
  mongo_setup:
    image: wdhif/mongo-replicaset-setup
    links:
      - mongo_1
      - mongo_2
      - mongo_3
    environment:
      DATABASE: admin
      REPLICA_SET_ID: rs
      PRIMARY_MEMBER: ${mongo.primary}:27017
      SECONDARY_MEMBERS: ${mongo.secondary1}:27017,${mongo.secondary2}:27017